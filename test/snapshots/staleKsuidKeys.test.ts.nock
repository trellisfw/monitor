[
  [
    "should have status: failure for resource w/ old ksuid key",
    [
      {
        "body": {
        },
        "method": "PUT",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id2 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:38 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D515HUqNon8bypwUNKFMLECVU",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "1",
          "etag",
          "\"1\"",
          "x-request-id",
          "req-334"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "content-type": "application/json",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 201
      },
      {
        "body": {
          "{{ oldKSUID }}": true
        },
        "method": "PUT",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id2 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:38 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D515HUqNon8bypwUNKFMLECVU",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "2",
          "etag",
          "\"2\"",
          "x-request-id",
          "req-336"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "content-type": "application/json",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 201
      },
      {
        "body": "",
        "method": "GET",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id2 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:38 GMT",
          "Content-Type",
          "application/json",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin, Accept",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D515HUqNon8bypwUNKFMLECVU",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "2",
          "etag",
          "\"2\"",
          "x-request-id",
          "req-338"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "host": "localhost"
        },
        "response": {
          "1nwvWeTJTcmgpTCLoys9FDh73tV": true,
          "_id": "resources/TRELLIS-MONITOR-TEST-25D515HUqNon8bypwUNKFMLECVU",
          "_meta": {
            "_id": "resources/TRELLIS-MONITOR-TEST-25D515HUqNon8bypwUNKFMLECVU/_meta",
            "_rev": 2
          },
          "_rev": 2,
          "_type": "application/json"
        },
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 200
      },
      {
        "body": "",
        "method": "DELETE",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id2 }}/{{ oldKSUID }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:39 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D515HUqNon8bypwUNKFMLECVU/1nwvWeTJTcmgpTCLoys9FDh73tV",
          "x-oada-path-leftover",
          "/1nwvWeTJTcmgpTCLoys9FDh73tV",
          "x-oada-rev",
          "3",
          "etag",
          "\"3\"",
          "x-request-id",
          "req-33a"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 204
      },
      {
        "body": "",
        "method": "DELETE",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id2 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:39 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D515HUqNon8bypwUNKFMLECVU",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "0",
          "etag",
          "\"0\"",
          "x-request-id",
          "req-33c"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 204
      }
    ]
  ],
  [
    "should have status: success for resource w/ recent ksuid key",
    [
      {
        "body": {
        },
        "method": "PUT",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id1 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:37 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D50zCqPiMd115khLWpN0SOXFp",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "1",
          "etag",
          "\"1\"",
          "x-request-id",
          "req-32m"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "content-type": "application/json",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 201
      },
      {
        "body": {
          "25D513ft4e2sxeU9V8uYDMNhK6q": true
        },
        "method": "PUT",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id1 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:38 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D50zCqPiMd115khLWpN0SOXFp",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "2",
          "etag",
          "\"2\"",
          "x-request-id",
          "req-32z"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "content-type": "application/json",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 201
      },
      {
        "body": "",
        "method": "GET",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id1 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:38 GMT",
          "Content-Type",
          "application/json",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin, Accept",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D50zCqPiMd115khLWpN0SOXFp",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "2",
          "etag",
          "\"2\"",
          "x-request-id",
          "req-330"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "host": "localhost"
        },
        "response": {
          "25D513ft4e2sxeU9V8uYDMNhK6q": true,
          "_id": "resources/TRELLIS-MONITOR-TEST-25D50zCqPiMd115khLWpN0SOXFp",
          "_meta": {
            "_id": "resources/TRELLIS-MONITOR-TEST-25D50zCqPiMd115khLWpN0SOXFp/_meta",
            "_rev": 2
          },
          "_rev": 2,
          "_type": "application/json"
        },
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 200
      },
      {
        "body": "",
        "method": "DELETE",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id1 }}/25D513ft4e2sxeU9V8uYDMNhK6q",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:38 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D50zCqPiMd115khLWpN0SOXFp/25D513ft4e2sxeU9V8uYDMNhK6q",
          "x-oada-path-leftover",
          "/25D513ft4e2sxeU9V8uYDMNhK6q",
          "x-oada-rev",
          "3",
          "etag",
          "\"3\"",
          "x-request-id",
          "req-332"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 204
      },
      {
        "body": "",
        "method": "DELETE",
        "path": "/resources/TRELLIS-MONITOR-TEST-{{ id1 }}",
        "rawHeaders": [
          "Server",
          "nginx",
          "Date",
          "Wed, 16 Feb 2022 21:56:38 GMT",
          "Connection",
          "keep-alive",
          "Content-Security-Policy",
          "default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests",
          "Cross-Origin-Embedder-Policy",
          "require-corp",
          "Cross-Origin-Opener-Policy",
          "same-origin",
          "Cross-Origin-Resource-Policy",
          "cross-origin",
          "X-DNS-Prefetch-Control",
          "off",
          "Expect-CT",
          "max-age=0",
          "X-Frame-Options",
          "SAMEORIGIN",
          "Strict-Transport-Security",
          "max-age=15552000; includeSubDomains",
          "X-Download-Options",
          "noopen",
          "X-Content-Type-Options",
          "nosniff",
          "Origin-Agent-Cluster",
          "?1",
          "X-Permitted-Cross-Domain-Policies",
          "none",
          "Referrer-Policy",
          "no-referrer",
          "X-XSS-Protection",
          "0",
          "vary",
          "Origin",
          "access-control-allow-origin",
          "*",
          "access-control-expose-headers",
          "x-oada-rev, x-oada-path-leftover, location, content-location",
          "content-location",
          "/resources/TRELLIS-MONITOR-TEST-25D50zCqPiMd115khLWpN0SOXFp",
          "x-oada-path-leftover",
          "",
          "x-oada-rev",
          "0",
          "etag",
          "\"0\"",
          "x-request-id",
          "req-333"
        ],
        "reqheaders": {
          "accept": "application/json,text/*;q=0.9,*/*;q=0.8",
          "accept-encoding": "br;q=1, gzip;q=0.8, deflate;q=0.5",
          "connection": "keep-alive",
          "host": "localhost"
        },
        "response": "",
        "responseIsBinary": false,
        "scope": "http://localhost:80",
        "status": 204
      }
    ]
  ]
]
